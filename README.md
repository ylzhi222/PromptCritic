# ğŸ¤– PromptCriticï¼šåŸºäºBERTçš„å¤§è¯­è¨€æ¨¡å‹è¾“å‡ºè´¨é‡åˆ†ç±»å™¨

PromptCritic æ˜¯ä¸€ä¸ªè½»é‡ä½†å¼ºå¤§çš„æ·±åº¦å­¦ä¹ å·¥å…·ï¼Œç”¨äºè‡ªåŠ¨è¯„ä¼°å¤§è¯­è¨€æ¨¡å‹ï¼ˆLLMsï¼‰ç”Ÿæˆçš„å›ç­”è´¨é‡ã€‚å®ƒåŸºäº PyTorch æ„å»ºï¼Œå¹¶ä» BERT å¾®è°ƒè€Œæ¥ï¼Œå°†å›ç­”åˆ†ç±»ä¸ºä¸‰ä¸ªç­‰çº§ â€”â€” **ä½**ã€**ä¸­** å’Œ **é«˜**ï¼Œä¸ºæç¤ºè¯ä¼˜åŒ–ã€æ•°æ®é›†ç­›é€‰å’Œ LLM è¯„ä¼°ç ”ç©¶æä¾›äº†åŸºç¡€ã€‚

---

## ğŸ“Œ åŠŸèƒ½ç‰¹æ€§

* âœ… å¾®è°ƒçš„ BERT åˆ†ç±»å™¨ï¼ˆ`bert-base-uncased`ï¼‰
* âœ… ä¸‰ç±»åˆ†ç±»ï¼šä½ (0)ã€ä¸­ (1)ã€é«˜ (2)
* âœ… åŸºäº [UltraFeedback æ•°æ®é›†](https://huggingface.co/datasets/openbmb/UltraFeedback)
* âœ… æ”¯æŒè¯„ä¼°ã€æ‰¹é‡é¢„æµ‹å’Œå¯è§†åŒ–
* âœ… æ˜“äºé‡æ–°è®­ç»ƒæˆ–æ‰©å±•ï¼ˆæ”¯æŒæ—©åœã€åŠ æƒæŸå¤±ï¼‰

---

## ğŸ§  è´¨é‡è¯„ä¼°æ ‡å‡†

æ¯ä¸ªç­”æ¡ˆæ ¹æ®ä»¥ä¸‹äº”ä¸ªå› ç´ è¿›è¡Œæ‰“åˆ†ï¼š

1. âœ… **æ˜¯å¦å›ç­”äº†é—®é¢˜**ï¼ˆæ˜¯ / å¦ï¼‰
2. ğŸ§  **äº‹å®å‡†ç¡®æ€§**ï¼ˆæ˜¯ / å¦ï¼Œå¯é€‰ç”¨æœç´¢éªŒè¯ï¼‰
3. ğŸ—£ï¸ **æ¸…æ™°ä¸ç®€æ´åº¦**ï¼ˆå¥½ / ä¸€èˆ¬ / å·®ï¼‰
4. ğŸ§± **é€»è¾‘ç»“æ„**ï¼ˆæ˜¯ / å¦ï¼‰
5. ğŸ“ **ç¯‡å¹…æˆ–å†—ä½™é—®é¢˜**ï¼ˆæ˜¯ / å¦ï¼‰

æœ€ç»ˆæ ‡ç­¾ï¼š

* **0 = ä½è´¨é‡**ï¼šè‡†æµ‹ã€è·‘é¢˜ã€ä¸è¿è´¯
* **1 = ä¸­è´¨é‡**ï¼šéƒ¨åˆ†æ­£ç¡®æˆ–å†—é•¿
* **2 = é«˜è´¨é‡**ï¼šå‡†ç¡®ã€æœ‰å¸®åŠ©ã€æ¸…æ™°

---

## ğŸ—‚ é¡¹ç›®ç»“æ„

```
PromptCritic/
â”œâ”€â”€ data/
â”‚   â””â”€â”€ README.md                 # æœ€ç»ˆçš„å¹³è¡¡æ•°æ®é›†ï¼ˆæ¯ç±»2000æ¡ï¼‰
â”œâ”€â”€ models/
â”‚   â””â”€â”€ bert-critic-1.0/          # æœ€ç»ˆä¿å­˜çš„æ¨¡å‹ï¼ˆHuggingFace æ ¼å¼ï¼‰
â”œâ”€â”€ scripts/
â”‚   â”œâ”€â”€ convert_ultrafeedback.py  # å°† UltraFeedback è½¬æ¢ä¸ºå·²æ ‡æ³¨çš„ CSV
â”‚   â”œâ”€â”€ dataset_builder.py        # æ•°æ®é›† + åˆ†è¯å™¨å¤„ç†å™¨
â”‚   â”œâ”€â”€ train.py                  # åŸºçº¿è®­ç»ƒè„šæœ¬
â”‚   â”œâ”€â”€ train_V2.py               # å¸¦æ—©åœå’Œç±»åˆ«æƒé‡çš„è®­ç»ƒ
â”‚   â”œâ”€â”€ evaluate.py               # æ¨¡å‹è¯„ä¼°ä¸æ··æ·†çŸ©é˜µ
â”‚   â”œâ”€â”€ predict.py                # è‡ªå®šä¹‰è¾“å…¥æˆ–æ‰¹é‡æ¨ç†
â”‚   â”œâ”€â”€ frequency.py              # æ ‡ç­¾é¢‘ç‡åˆ†æ
â”‚   â”œâ”€â”€ small_sample.py           # æ¯ä¸ªæ ‡ç­¾ç­‰é‡é‡‡æ ·
â”‚   â””â”€â”€ small_sample_random.py    # ä¿ç•™æ ‡ç­¾æ¯”ä¾‹çš„éšæœºé‡‡æ ·
â”œâ”€â”€ results/
â”‚   â””â”€â”€ confusion_matrix.png      # è¯„ä¼°å¯è§†åŒ–å›¾
â”œâ”€â”€ requirements.txt
â””â”€â”€ README.md
```

---

## ğŸ§ª å¿«é€Ÿå¼€å§‹

### 1. å®‰è£…ä¾èµ–

```bash
pip install -r requirements.txt
```

### 2. è®­ç»ƒæ¨¡å‹

```bash
python scripts/train.py \
    --csv_path data/6000.csv \
    --model_name bert-base-uncased \
    --epochs 4 \
    --batch_size 16 \
    --lr 2e-5 \
    --output_dir models/bert-critic-1.0
```

### 3. è¯„ä¼°æ¨¡å‹

```bash
python scripts/evaluate.py \
    --model_dir models/bert-critic-1.0 \
    --csv_path data/6000.csv
```

### 4. é¢„æµ‹

```bash
python scripts/predict.py \
    --model_dir models/bert-critic-1.0 \
    --csv_path your_prompts.csv
```

---

## ğŸ¯ ç»“æœå±•ç¤ºï¼ˆåŸºäº6000ä¸ªå¹³è¡¡æ ·æœ¬ï¼‰

| åˆ†ç±»     | ç²¾ç¡®ç‡ (Precision) | å¬å›ç‡ (Recall) | F1 åˆ†æ•°         |
| ------ | --------------- | ------------ | ------------- |
| ä½ (0)  | 0.764           | 0.863        | 0.811         |
| ä¸­ (1)  | 0.766           | 0.597        | 0.671         |
| é«˜ (2)  | 0.741           | 0.809        | 0.774         |
| **æ€»ä½“** |                 |              | **0.756 å‡†ç¡®ç‡** |

ğŸ‘‰ æ··æ·†çŸ©é˜µä¸åˆ†ç±»æŠ¥å‘Šä¿å­˜åœ¨ `results/confusion_matrix.png`ã€‚

---

## ğŸ§© æ•°æ®é›†æ¦‚è§ˆ

* æ¥æºï¼š[UltraFeedback (openbmb)](https://huggingface.co/datasets/openbmb/UltraFeedback)
* æœ€ç»ˆå­é›†ï¼š6000 ä¸ªæ ·æœ¬ï¼ˆæ¯ä¸ªæ ‡ç­¾2000æ¡ï¼‰
* é€šè¿‡è„šæœ¬ `convert_ultrafeedback.py` è½¬æ¢å¹¶æ ‡æ³¨
* å¹³è¡¡ä¸”æ¸…æ´—è¿‡ï¼Œé€‚ç”¨äºå¯å¤ç°è®­ç»ƒ

---

## ğŸ—ƒ æ¨¡å‹ä¸‹è½½

æœ€ç»ˆæ¨¡å‹ä¿å­˜åœ¨ï¼š

ğŸ“ `models/bert-critic-1.0/`
å¯ä¸ HuggingFace Transformers ä¸€èµ·ä½¿ç”¨ï¼š

```python
from transformers import BertForSequenceClassification
model = BertForSequenceClassification.from_pretrained("models/bert-critic-1.0")
```

---

## ğŸ“Œ æœªæ¥è®¡åˆ’

* [ ] Streamlit ç½‘é¡µæ¼”ç¤ºï¼ˆLLM + Critic äº’åŠ¨ï¼‰
* [ ] å€ŸåŠ© GPT åé¦ˆå¾ªç¯çš„æ ‡æ³¨è¾…åŠ©
* [ ] æ‰©å±•è‡³å¤šè¯­è¨€å›ç­”æˆ– GPT-4 è¾“å‡º
* [ ] åŸºäºå›å½’çš„ç»†ç²’åº¦è¯„åˆ†

---

## ğŸ™ è‡´è°¢

* æ„Ÿè°¢ [OpenBMB](https://github.com/OpenBMB) æä¾› UltraFeedback æ•°æ®é›†
* æ„Ÿè°¢ HuggingFace Transformers æä¾›é¢„è®­ç»ƒæ¨¡å‹
* æ„Ÿè°¢ç¤¾åŒºæˆå‘˜å¯¹ LLM è¯„ä¼°çš„è§è§£è´¡çŒ®

---

å¦‚æœä½ è§‰å¾—è¿™ä¸ªé¡¹ç›®æœ‰ç”¨ï¼Œæ¬¢è¿ â­ æ”¶è—æœ¬ä»“åº“ï¼
